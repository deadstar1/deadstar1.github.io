<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>PoC for robotlegs—a MVC Flex applications vulnerable to CVE-2011-2461</title>
  <meta name="description" content="PoC for robotlegs—a MVC Flex applications vulnerable to CVE-2011-2461">

  <!-- CSS files -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  <link rel="stylesheet" href="http://192.168.33.177:4000//css/main.css">
  <link rel="stylesheet" href="http://192.168.33.177:4000//css/responsivediv.css">

  <link rel="canonical" href="http://192.168.33.177:4000//articles/2017-05/mvc-flex">
  <link rel="alternate" type="application/rss+xml" title="Blog BLog" href="http://192.168.33.177:4000/ /feed.xml " />

  <!-- Icons -->
  <!-- 16x16 -->
  <link rel="shortcut icon" href="http://192.168.33.177:4000//favicon.ico">
  <!-- 32x32 -->
  <link rel="shortcut icon" href="http://192.168.33.177:4000//favicon.ico">

</head>


<body>
  <div class="row">
    <div class="col s12 m3">
      <div class="table cover">
         

<div class="cover-card table-cell table-middle">
  
  <img src="http://192.168.33.177:4000//img/profile.jpg" alt="this is me!" class="avatar">
  
  <a href="http://192.168.33.177:4000//" class="author_name">Adrian Belen</a>
  <span class="author_job">WEB APPLICATION SECURITY ENTHUSIAST, BREAKING THINGS FOR FUN & profit :D</span>
  <span class="author_bio mbm"></span>
  <nav class="nav">
    <ul class="nav-list">
       
      <li class="nav-item">
        <a href="http://192.168.33.177:4000//about me ">about me</a>
        <span>/</span>
      </li>
      
      <li class="nav-item">
        <a href="http://192.168.33.177:4000//archive">archive</a>
        <span>/</span>
      </li>
      
      <li class="nav-item">
        <a href="http://192.168.33.177:4000//categories">categories</a>
      </li>
     
    </ul>
  </nav>
  <div class="social-links">
  <ul>
    
    <li><a href="http://twitter.com/nukesec" class="social-link-item" target="_blank"><i class="fab fa-twitter-square"></i></a></li>
    
    
    
    
    
    
    <li><a href="http://github.com/deadstar1" class="social-link-item" target="_blank"><i class="fab fa-github"></i></a></li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    <li>
      <a title='Hackerone' href="http://hackerone.com/adrianbelen" class="social-link-item" target="_blank">
        <svg width="20px" height="15px" viewBox="0 0 39 74" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
    <!-- Generator: Sketch 3.4.2 (15855) - http://www.bohemiancoding.com/sketch -->
    <title>Untitled 3</title>
    <desc>Created with Sketch.</desc>
    <defs>
        <path id="path-1" d="M0.06,3.60329081 C0.212928399,2.89925466 0.657587482,2.30266801 1.387,1.823 C2.307,1.223 3.497,0.915 4.958,0.915 C6.357,0.915 7.547,1.223 8.535,1.823 C9.523,2.44 10.014,3.219 10.014,4.183 L10.014,70.051 C10.014,70.887 9.499,71.652 8.486,72.35 C7.467,73.056 6.295,73.407 4.958,73.407 C3.559,73.407 2.387,73.056 1.436,72.35 C0.673931664,71.7899832 0.215600576,71.1951631 0.06,70.5544658 L0.06,3.60329081 L0.06,3.60329081 Z"></path>
        <path id="path-3" d="M0.787,9.392 C0.187,9.954 -0.071,10.807 0.04,11.974 C0.143,13.13 0.677,14.23 1.623,15.268 C2.573,16.313 3.635,16.968 4.85,17.246 C6.046,17.517 6.955,17.369 7.555,16.813 L12.857,13.506 L12.857,43.051 C12.857,43.887 13.317,44.646 14.249,45.35 C15.158,46.056 16.324,46.407 17.723,46.407 C19.122,46.407 20.33,46.056 21.343,45.35 C22.361,44.646 22.871,43.887 22.871,43.051 L22.871,3.329 C22.871,2.365 22.374,1.587 21.392,0.988 C20.41,0.376 19.189,0.079 17.723,0.079 C16.262,0.079 15.09,0.376 14.194,0.988 L0.787,9.392 L0.787,9.392 Z"></path>
    </defs>
    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
        <g id="HackerOne---short" sketch:type="MSLayerGroup">
            <g id="Page-1">
                <g id="Group-3">
                    <mask id="mask-2" sketch:name="Clip 2" fill="white">
                        <use xlink:href="#path-1"></use>
                    </mask>
                    <g id="Clip-2"></g>
                    <path d="M0.06,0.8 L10.02,0.8 L10.02,73.52 L0.06,73.52 L0.06,0.8 Z" id="Fill-1" fill="#8d7edc" sketch:type="MSShapeGroup" mask="url(#mask-2)"></path>
                </g>
                <g id="Group-6" transform="translate(16.000000, 27.000000)">
                    <mask id="mask-4" sketch:name="Clip 5" fill="white">
                        <use xlink:href="#path-3"></use>
                    </mask>
                    <g id="Clip-5"></g>
                    <path d="M0.02,-0.04 L22.94,-0.04 L22.94,46.52 L0.02,46.52 L0.02,-0.04 Z" id="Fill-4" fill="#8d7edc" sketch:type="MSShapeGroup" mask="url(#mask-4)"></path>
                </g>
            </g>
        </g>
    </g>
</svg>
      </a>
    </li>
    
    
    
    <li>
      <a title='Bugcrowd' href="http://bugcrowd.com/adrianbelen" class="social-link-item" target="_blank">
        <?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="20px" height="17px" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg">
<path fill="#8d7edc" d=" M 0.00 0.00 L 100.00 0.00 L 100.00 100.00 L 0.00 100.00 L 0.00 0.00 Z" />
<path fill="#fffffe" d=" M 26.11 19.79 C 30.62 19.82 35.19 19.42 39.65 20.20 C 41.19 21.24 42.07 23.05 41.93 24.91 C 42.00 30.37 41.96 35.84 41.87 41.31 C 49.00 32.65 64.62 33.90 70.17 43.67 C 75.42 52.52 75.40 64.75 69.23 73.14 C 63.04 81.81 48.35 83.06 41.46 74.61 C 41.33 76.19 41.24 77.77 41.21 79.35 C 37.86 79.32 34.44 79.91 31.14 79.04 C 31.28 62.33 31.33 45.60 31.12 28.88 C 29.45 28.81 27.79 28.71 26.12 28.58 C 26.07 25.65 26.09 22.72 26.11 19.79 Z" />
<path fill="#8d7edc" d=" M 48.25 45.30 C 53.43 42.87 59.98 45.70 61.96 51.01 C 64.53 57.41 63.73 66.39 57.33 70.25 C 52.22 73.40 45.03 70.69 42.92 65.16 C 40.21 58.56 40.99 48.63 48.25 45.30 Z" />
</svg>

      </a>
    </li>
    
  </ul>
</div>

</div>

      </div>
    </div>
    <div class="col s12 m9">
      <div class="post-listing">
        <div class="back-home">
  <a href="http://192.168.33.177:4000//">< back Home.</a>
</div>



<div id="post">
  <header class="post-header">
    <h1 title="PoC for robotlegs—a MVC Flex applications vulnerable to CVE-2011-2461">PoC for robotlegs—a MVC Flex applications vulnerable to CVE-2011-2461</h1>
    <span class="post-meta">
      <span class="post-date">
        23 MAY 2017
      </span>
      •
      <span class="read-time" title="Estimated read time">
  
  
    1 min read
  
</span>

    </span>

  </header>

  <article class="post-content">
    <p>Last year when I participated in a bug bounty program, I have found a web application that hosted a vulnerable <code>.swf</code> on their CDN. My PoC abuses the CDN as the intermediate from the web app to attacker host.The PoC abuses robotlegs-framework-v1.5.2 a vulnerable ActionScript Application Framework which allows SoP bypass.</p>

<p>It is not typical to exploit it (to read the HTTP Response of the vulnerable web app) because  the vulnerable <code>.SWF</code> file is hosted on the CDN. In addition, the attacker can only do SOP bypass on the CDN. However, a <code>crossdomain.xml </code> policy of the vulnerable app allowed cross domain communication between the vulnerable web app and its CDN.
&gt; Adobe Flex SDK is prone to a cross-site scripting vulnerability because it fails to properly sanitize user-supplied input to express-install template files.</p>

<blockquote>
  <p>An attacker could exploit this vulnerability to execute arbitrary script code in the context of a web application built using the SDK. This may allow the attacker to steal cookie-based authentication credentials and launch other attacks.</p>
</blockquote>

<blockquote>
  <p>Adobe Flex SDK 4.5.1 and prior versions are affected. http://www.securityfocus.com/bid/50869/discuss</p>
</blockquote>

<p><img src="/img/chart.png" alt="" /></p>

<p>The vulnerable SWF file has 3 GET parameter which are game, config, and type. <code>config</code> parameter is used to load config.xml which is located in CDN domain.</p>

<p>config.xml looks like this.</p>

<pre><code>&lt;root&gt;
&lt;module type="game" url="GameViewer.swf"/&gt;
&lt;module type="puzzle" url="Puzzle.swf"/&gt;
&lt;default&gt;
&lt;type&gt;puzzle&lt;/type&gt;
&lt;game&gt;assets/data.json&lt;/game&gt;
&lt;/default&gt;
&lt;/root&gt;
</code></pre>

<p>Based on config.xml file, vulnerable SWF file extends the module class of robotlegs MVC. Besides, main.swf loads gameviewer.swf and puzzle.swf modules.</p>

<p>The malicious user could force main.swf to load or inject malicious remote module(malicious swf files hosted in the attacker’s server) to itself by changing the config parameter.The injected malicious remote module can send AJAX request and read HTTP response of victim website. In other words, the malicious user can read messages, steal CSRF token, and send ajax request (change password of the victim, or any other actions)— Same-Origin Policy Bypass.</p>

<p><a href="https://threatpost.com/adobe-cve-2011-2461-remains-exploitable-four-years-after-patch/111754/">More information here</a></p>

<p>true<script src="https://gist.github.com/6ec49529d2f5f7ac23634059147b9edb.js"> </script></p>

<p><strong>References:</strong>
- <a href="http://www.digitaldogbyte.com/2010/08/17/robotlegs-modular-utilities-tutorial/">http://www.digitaldogbyte.com/2010/08/17/robotlegs-modular-utilities-tutorial/</a>
- <a href="http://www.adobe.com/devnet/actionscript/articles/intro-robotlegs-pt1.html">Get an overview of this framework for ActionScript 3 development through a simple</a>
- <a href="http://joelhooks.com/2010/05/02/modular-robotlegs/">http://joelhooks.com/2010/05/02/modular-robotlegs/</a></p>

  </article>
</div>

<div class="share-buttons">
  <h6>Share on: </h6>
  <ul>
    <li>
      <a href='https://twitter.com/intent/tweet?text=http://maradrianbelen.com/articles/2017-05/mvc-flex @nukesec' class="twitter btn" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=http://maradrianbelen.com/articles/2017-05/mvc-flex @nukesec'" class="facebook btn" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=http://maradrianbelen.com/articles/2017-05/mvc-flex" class="google-plus btn" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
    <li>
      <a href="https://news.ycombinator.com/submitlink?u=http://maradrianbelen.com/articles/2017-05/mvc-flex" class="hacker-news btn" title="Share on Hacker News"><i class="fa fa-hacker-news"></i><span> Hacker News</span></a>
    </li>
    <li>
      <a href="https://www.reddit.com/submit?url=http://maradrianbelen.com/articles/2017-05/mvc-flex" class="reddit btn" title="Share on Reddit"><i class="fa fa-reddit"></i><span> Reddit</span></a>
    </li>
  </ul>
</div><!-- end share-buttons -->



        <footer>
  &copy; 2019 Adrian Belen. Powered by <a href="http://jekyllrb.com/">Jekyll</a>,  made with <i class="fa fa-heart heart-icon"></i>
</footer>

      </div>
    </div>
  </div>
  <script type="text/javascript" src="http://192.168.33.177:4000//js/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="http://192.168.33.177:4000//js/main.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.1/anchor.min.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75403295-1', 'auto');
  ga('send', 'pageview');
</script>
<script type="text/javascript">
 // anchors.options.icon='';
  anchors.add('h2');
</script>


</body>

<!-- some random motos here-->
  <script type="text/javascript">
    //list of motos
    var motos = [
    //"In the end, people will judege you anyway, so don't live your life impressing others - live your life impressing yourself",
    //"Live life to express, not to impress",
    "<b>Success</b> is the ability to go from one failure to another with no loss of enthusiasm."
    //"<b>IF</b> no mistake have you made, yet losing you are... a different game you should play </br> - Master Yoda"
    //"<b>No free quote for the day!</b>",
    //"Your dream doesn't have an expiration date. Take a deep breath, and try again.",
    //"There is nothing wrong with being mediocre, there is something wrong with not wanting to improve past mediocrity."
    ];
    var len =motos.length
    var x = Math.floor((Math.random() * len ) + 1);
    document.getElementsByClassName('author_bio')[0].innerHTML='"'+motos[x-1] + '" </br> -Sir Winston Churchill';
    console.log('selected moto:' + motos[x-1]);
    console.log('moto count: ' + motos.length );
    console.log('random ' + x-1)
  </script>
</html>
